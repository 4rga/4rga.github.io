<!doctype html><meta charset="utf-8">
<title>Related Posts</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  html,body{margin:0;background:transparent;color:#111;font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

  /* Tanpa frame luar: wrap transparan & tanpa border/padding */
  .wrap{padding:0;background:transparent;border:0}

  /* Judul */
  .wrap h2{margin:0 0 12px;font-size:18px;font-weight:700;color:#4285f4}

  /* Grid “full” */
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media (min-width:480px){.grid{grid-template-columns:1fr 1fr}}
  @media (min-width:760px){.grid{grid-template-columns:1fr 1fr 1fr}}

  /* Kartu bersih, minim dekorasi */
  .card{display:flex;flex-direction:column;border-radius:10px;overflow:hidden;background:#fff;
        box-shadow:0 1px 2px rgba(0,0,0,.04);transition:transform .18s ease,box-shadow .18s ease}
  .card:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(0,0,0,.08)}

  /* Thumbnail */
  .thumb{position:relative;aspect-ratio:16/9;background:#f2f3f5}
  .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block}

  .meta{padding:10px 12px}
  .title{display:block;font-weight:700;line-height:1.35;text-decoration:none;color:#111}
  .title:hover{color:#4285f4}
  .snippet{margin-top:6px;font-size:13px;color:#666;line-height:1.45}

  .title,.snippet{display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}
  .title{-webkit-line-clamp:2}
  .snippet{-webkit-line-clamp:3}
</style>

<div class="wrap" id="wrap"><h2>Artikel Terkait</h2><div>Memuat artikel…</div></div>

<script>
(function(){
  function qs(k){return new URL(location.href).searchParams.get(k)||""}
  var blog    = (qs("blog")||"").replace(/\/+$/,'') + "/";
  var label   = (qs("label")||"").trim();
  var max     = Math.max(1, parseInt(qs("max")||"6",10));
  var current = (qs("current")||"").trim().replace(/\/+$/,'');

  if(!blog || !label){
    document.getElementById('wrap').innerHTML = "<h2>Artikel Terkait</h2><div>Param blog/label kosong.</div>";
    return;
  }

  var feedUrl = blog + "feeds/posts/summary/-/" + encodeURIComponent(label)
              + "?alt=json-in-script&max-results=" + encodeURIComponent(max+1)
              + "&callback=relCb";

  function esc(s){return String(s||"").replace(/&/g,"&amp;").replace(/<//g,"&lt;").replace(/"/g,"&quot;")}
  function stripTags(s){return String(s||"").replace(/<[^>]*>/g,"")}
  function truncate(s, n){
    s = s.trim();
    if(s.length<=n) return s;
    var cut = s.slice(0,n);
    var sp = cut.lastIndexOf(" ");
    return (sp>50?cut.slice(0,sp):cut) + "…";
  }

  window.relCb = function(data){
    var wrap = document.getElementById('wrap');
    var entries = data && data.feed && data.feed.entry ? data.feed.entry : [];
    if(!entries.length){ wrap.innerHTML = "<h2>Artikel Terkait</h2><div>Tidak ada artikel terkait.</div>"; return; }

    function getLink(e){ var a=(e.link||[]).find(l=>l.rel==="alternate"); return a?a.href:"#"; }
    function getThumb(e){
      var t=e["media$thumbnail"]&&e["media$thumbnail"].url;
      if (t) { t = t.replace(/\/s\d+(-c)?\//, "/s600/"); }   // gambar tajam
      return t || "https://2.bp.blogspot.com/-ex3V86fj4dQ/UrCQQa4cLsI/AAAAAAAAFdA/j2FCTmGOrog/s160/no-thumbnail.png";
    }

    var list = entries.filter(function(it){
      var link = getLink(it).replace(/\/+$/,'');
      return !current || link !== current;
    }).slice(0, max);

    if(!list.length){ wrap.innerHTML = "<h2>Artikel Terkait</h2><div>Tidak ada artikel terkait.</div>"; return; }

    var html = '<h2>Artikel Terkait</h2><div class="grid">' + list.map(function(it){
      var link = esc(getLink(it));
      var ttl  = esc(it.title && it.title.$t);
      var th   = esc(getThumb(it));
      var sumRaw = it.summary && it.summary.$t ? stripTags(it.summary.$t) : "";
      var sum  = esc(truncate(sumRaw, 150));
      return '<article class="card">'
           +   '<a class="thumb" href="'+link+'" target="_blank" rel="noopener">'
           +     '<img loading="lazy" src="'+th+'" alt="'+ttl+'">'
           +   '</a>'
           +   '<div class="meta">'
           +     '<a class="title" href="'+link+'" target="_blank" rel="noopener">'+ttl+'</a>'
           +     (sum ? '<div class="snippet">'+sum+'</div>' : '')
           +   '</div>'
           + '</article>';
    }).join('') + '</div>';

    wrap.innerHTML = html;
  };

  var s = document.createElement('script');
  s.src = feedUrl;
  s.onerror = function(){ document.getElementById('wrap').innerHTML = "<h2>Artikel Terkait</h2><div>Gagal memuat feed.</div>"; };
  document.head.appendChild(s);
})();
</script>
